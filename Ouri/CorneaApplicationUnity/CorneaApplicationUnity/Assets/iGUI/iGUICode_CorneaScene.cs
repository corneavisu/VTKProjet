using UnityEngine;
using System.Collections;
using iGUI;
using System;

public class iGUICode_CorneaScene : MonoBehaviour{
	[HideInInspector]
	public iGUIFloatHorizontalSlider floatHorizontalSlider4;
	[HideInInspector]
	public iGUIFloatHorizontalSlider floatHorizontalSlider3;
	[HideInInspector]
	public iGUIButton button4;
	[HideInInspector]
	public iGUIButton button3;
	[HideInInspector]
	public iGUIButton button2;
	[HideInInspector]
	public iGUIButton button1;
	[HideInInspector]
	public iGUILabel label153;
	[HideInInspector]
	public iGUILabel label152;
	[HideInInspector]
	public iGUICheckboxGroup checkboxGroup4;
	[HideInInspector]
	public iGUIPanel panel7;
	[HideInInspector]
	public iGUIPanel panel6;
	[HideInInspector]
	public iGUIPanel panel5;
	[HideInInspector]
	public iGUIPanel panel4;
	[HideInInspector]
	public iGUITabPanel tabPanel2;
	[HideInInspector]
	public iGUIContainer container10;
	[HideInInspector]
	public iGUIGradient gradient102;
	[HideInInspector]
	public iGUIGradient gradient101;
	[HideInInspector]
	public iGUIGradient gradient100;
	[HideInInspector]
	public iGUIGradient gradient99;
	[HideInInspector]
	public iGUIGradient gradient98;
	[HideInInspector]
	public iGUIGradient gradient97;
	[HideInInspector]
	public iGUIGradient gradient96;
	[HideInInspector]
	public iGUIGradient gradient95;
	[HideInInspector]
	public iGUIGradient gradient94;
	[HideInInspector]
	public iGUIGradient gradient93;
	[HideInInspector]
	public iGUIGradient gradient92;
	[HideInInspector]
	public iGUIGradient gradient91;
	[HideInInspector]
	public iGUIGradient gradient90;
	[HideInInspector]
	public iGUIGradient gradient89;
	[HideInInspector]
	public iGUIGradient gradient88;
	[HideInInspector]
	public iGUIGradient gradient87;
	[HideInInspector]
	public iGUIGradient gradient86;
	[HideInInspector]
	public iGUIGradient gradient85;
	[HideInInspector]
	public iGUIGradient gradient84;
	[HideInInspector]
	public iGUIGradient gradient83;
	[HideInInspector]
	public iGUIGradient gradient82;
	[HideInInspector]
	public iGUIGradient gradient81;
	[HideInInspector]
	public iGUIGradient gradient80;
	[HideInInspector]
	public iGUIGradient gradient79;
	[HideInInspector]
	public iGUIGradient gradient78;
	[HideInInspector]
	public iGUIGradient gradient77;
	[HideInInspector]
	public iGUIGradient gradient76;
	[HideInInspector]
	public iGUIGradient gradient75;
	[HideInInspector]
	public iGUIGradient gradient74;
	[HideInInspector]
	public iGUIGradient gradient73;
	[HideInInspector]
	public iGUIGradient gradient72;
	[HideInInspector]
	public iGUIGradient gradient71;
	[HideInInspector]
	public iGUIGradient gradient70;
	[HideInInspector]
	public iGUIGradient gradient69;
	[HideInInspector]
	public iGUIContainer container9;
	[HideInInspector]
	public iGUIImage image106;
	[HideInInspector]
	public iGUIImage image105;
	[HideInInspector]
	public iGUIImage image104;
	[HideInInspector]
	public iGUIImage image103;
	[HideInInspector]
	public iGUIImage image102;
	[HideInInspector]
	public iGUIImage image101;
	[HideInInspector]
	public iGUIImage image100;
	[HideInInspector]
	public iGUIImage image99;
	[HideInInspector]
	public iGUIImage image98;
	[HideInInspector]
	public iGUIImage image97;
	[HideInInspector]
	public iGUIImage image96;
	[HideInInspector]
	public iGUIImage image95;
	[HideInInspector]
	public iGUIImage image94;
	[HideInInspector]
	public iGUIImage image93;
	[HideInInspector]
	public iGUIImage image92;
	[HideInInspector]
	public iGUIImage image91;
	[HideInInspector]
	public iGUIImage image90;
	[HideInInspector]
	public iGUIImage image89;
	[HideInInspector]
	public iGUIImage image88;
	[HideInInspector]
	public iGUIImage image87;
	[HideInInspector]
	public iGUIImage image86;
	[HideInInspector]
	public iGUIImage image85;
	[HideInInspector]
	public iGUIImage image84;
	[HideInInspector]
	public iGUIImage image83;
	[HideInInspector]
	public iGUIImage image82;
	[HideInInspector]
	public iGUIImage image81;
	[HideInInspector]
	public iGUIImage image80;
	[HideInInspector]
	public iGUIImage image79;
	[HideInInspector]
	public iGUIImage image78;
	[HideInInspector]
	public iGUIImage image77;
	[HideInInspector]
	public iGUIImage image76;
	[HideInInspector]
	public iGUIImage image75;
	[HideInInspector]
	public iGUIImage image74;
	[HideInInspector]
	public iGUIImage image73;
	[HideInInspector]
	public iGUIImage image72;
	[HideInInspector]
	public iGUIContainer container8;
	[HideInInspector]
	public iGUICheckboxGroup checkboxGroup3;
	[HideInInspector]
	public iGUILabel label150;
	[HideInInspector]
	public iGUILabel label149;
	[HideInInspector]
	public iGUILabel label148;
	[HideInInspector]
	public iGUILabel label147;
	[HideInInspector]
	public iGUILabel label145;
	[HideInInspector]
	public iGUILabel label144;
	[HideInInspector]
	public iGUILabel label142;
	[HideInInspector]
	public iGUILabel label139;
	[HideInInspector]
	public iGUILabel label137;
	[HideInInspector]
	public iGUILabel label134;
	[HideInInspector]
	public iGUILabel label132;
	[HideInInspector]
	public iGUILabel label129;
	[HideInInspector]
	public iGUILabel label127;
	[HideInInspector]
	public iGUILabel label122;
	[HideInInspector]
	public iGUILabel label119;
	[HideInInspector]
	public iGUILabel label117;
	[HideInInspector]
	public iGUILabel label114;
	[HideInInspector]
	public iGUILabel label112;
	[HideInInspector]
	public iGUILabel label109;
	[HideInInspector]
	public iGUILabel label107;
	[HideInInspector]
	public iGUIContainer container7;
	[HideInInspector]
	public iGUIGradient gradient68;
	[HideInInspector]
	public iGUIGradient gradient67;
	[HideInInspector]
	public iGUIGradient gradient66;
	[HideInInspector]
	public iGUIGradient gradient65;
	[HideInInspector]
	public iGUIGradient gradient64;
	[HideInInspector]
	public iGUIGradient gradient63;
	[HideInInspector]
	public iGUIGradient gradient62;
	[HideInInspector]
	public iGUIGradient gradient61;
	[HideInInspector]
	public iGUIGradient gradient60;
	[HideInInspector]
	public iGUIGradient gradient59;
	[HideInInspector]
	public iGUIGradient gradient58;
	[HideInInspector]
	public iGUIGradient gradient57;
	[HideInInspector]
	public iGUIGradient gradient56;
	[HideInInspector]
	public iGUIGradient gradient55;
	[HideInInspector]
	public iGUIGradient gradient54;
	[HideInInspector]
	public iGUIGradient gradient53;
	[HideInInspector]
	public iGUIGradient gradient52;
	[HideInInspector]
	public iGUIGradient gradient51;
	[HideInInspector]
	public iGUIGradient gradient50;
	[HideInInspector]
	public iGUIGradient gradient49;
	[HideInInspector]
	public iGUIGradient gradient48;
	[HideInInspector]
	public iGUIGradient gradient47;
	[HideInInspector]
	public iGUIGradient gradient46;
	[HideInInspector]
	public iGUIGradient gradient45;
	[HideInInspector]
	public iGUIGradient gradient44;
	[HideInInspector]
	public iGUIGradient gradient43;
	[HideInInspector]
	public iGUIGradient gradient42;
	[HideInInspector]
	public iGUIGradient gradient41;
	[HideInInspector]
	public iGUIGradient gradient40;
	[HideInInspector]
	public iGUIGradient gradient39;
	[HideInInspector]
	public iGUIGradient gradient38;
	[HideInInspector]
	public iGUIGradient gradient37;
	[HideInInspector]
	public iGUIGradient gradient36;
	[HideInInspector]
	public iGUIGradient gradient35;
	[HideInInspector]
	public iGUIContainer container6;
	[HideInInspector]
	public iGUIImage image71;
	[HideInInspector]
	public iGUIImage image70;
	[HideInInspector]
	public iGUIImage image69;
	[HideInInspector]
	public iGUIImage image68;
	[HideInInspector]
	public iGUIImage image67;
	[HideInInspector]
	public iGUIImage image66;
	[HideInInspector]
	public iGUIImage image65;
	[HideInInspector]
	public iGUIImage image64;
	[HideInInspector]
	public iGUIImage image63;
	[HideInInspector]
	public iGUIImage image62;
	[HideInInspector]
	public iGUIImage image61;
	[HideInInspector]
	public iGUIImage image60;
	[HideInInspector]
	public iGUIImage image59;
	[HideInInspector]
	public iGUIImage image58;
	[HideInInspector]
	public iGUIImage image57;
	[HideInInspector]
	public iGUIImage image56;
	[HideInInspector]
	public iGUIImage image55;
	[HideInInspector]
	public iGUIImage image54;
	[HideInInspector]
	public iGUIImage image53;
	[HideInInspector]
	public iGUIImage image52;
	[HideInInspector]
	public iGUIImage image51;
	[HideInInspector]
	public iGUIImage image50;
	[HideInInspector]
	public iGUIImage image49;
	[HideInInspector]
	public iGUIImage image48;
	[HideInInspector]
	public iGUIImage image47;
	[HideInInspector]
	public iGUIImage image46;
	[HideInInspector]
	public iGUIImage image45;
	[HideInInspector]
	public iGUIImage image44;
	[HideInInspector]
	public iGUIImage image43;
	[HideInInspector]
	public iGUIImage image42;
	[HideInInspector]
	public iGUIImage image41;
	[HideInInspector]
	public iGUIImage image40;
	[HideInInspector]
	public iGUIImage image39;
	[HideInInspector]
	public iGUIImage image38;
	[HideInInspector]
	public iGUIImage image37;
	[HideInInspector]
	public iGUIContainer container5;
	[HideInInspector]
	public iGUIContainer container4;
	[HideInInspector]
	public iGUIGradient gradient34;
	[HideInInspector]
	public iGUIGradient gradient33;
	[HideInInspector]
	public iGUIGradient gradient32;
	[HideInInspector]
	public iGUIGradient gradient31;
	[HideInInspector]
	public iGUIGradient gradient30;
	[HideInInspector]
	public iGUIGradient gradient29;
	[HideInInspector]
	public iGUIGradient gradient28;
	[HideInInspector]
	public iGUIGradient gradient27;
	[HideInInspector]
	public iGUIGradient gradient26;
	[HideInInspector]
	public iGUIGradient gradient25;
	[HideInInspector]
	public iGUIGradient gradient24;
	[HideInInspector]
	public iGUIGradient gradient23;
	[HideInInspector]
	public iGUIGradient gradient22;
	[HideInInspector]
	public iGUIGradient gradient21;
	[HideInInspector]
	public iGUIGradient gradient20;
	[HideInInspector]
	public iGUIGradient gradient19;
	[HideInInspector]
	public iGUIGradient gradient18;
	[HideInInspector]
	public iGUIGradient gradient17;
	[HideInInspector]
	public iGUIGradient gradient16;
	[HideInInspector]
	public iGUIGradient gradient15;
	[HideInInspector]
	public iGUIGradient gradient14;
	[HideInInspector]
	public iGUIGradient gradient13;
	[HideInInspector]
	public iGUIGradient gradient12;
	[HideInInspector]
	public iGUIGradient gradient11;
	[HideInInspector]
	public iGUIGradient gradient10;
	[HideInInspector]
	public iGUIGradient gradient9;
	[HideInInspector]
	public iGUIGradient gradient8;
	[HideInInspector]
	public iGUIGradient gradient7;
	[HideInInspector]
	public iGUIGradient gradient6;
	[HideInInspector]
	public iGUIGradient gradient5;
	[HideInInspector]
	public iGUIGradient gradient4;
	[HideInInspector]
	public iGUIGradient gradient3;
	[HideInInspector]
	public iGUIGradient gradient2;
	[HideInInspector]
	public iGUIGradient gradient1;
	[HideInInspector]
	public iGUIContainer container3;
	[HideInInspector]
	public iGUILabel label143;
	[HideInInspector]
	public iGUILabel label140;
	[HideInInspector]
	public iGUILabel label138;
	[HideInInspector]
	public iGUILabel label135;
	[HideInInspector]
	public iGUILabel label133;
	[HideInInspector]
	public iGUILabel label130;
	[HideInInspector]
	public iGUILabel label128;
	[HideInInspector]
	public iGUILabel label125;
	[HideInInspector]
	public iGUILabel label124;
	[HideInInspector]
	public iGUILabel label123;
	[HideInInspector]
	public iGUILabel label120;
	[HideInInspector]
	public iGUILabel label118;
	[HideInInspector]
	public iGUILabel label115;
	[HideInInspector]
	public iGUILabel label113;
	[HideInInspector]
	public iGUILabel label110;
	[HideInInspector]
	public iGUILabel label108;
	[HideInInspector]
	public iGUILabel label105;
	[HideInInspector]
	public iGUILabel label104;
	[HideInInspector]
	public iGUILabel label103;
	[HideInInspector]
	public iGUILabel label102;
	[HideInInspector]
	public iGUIImage image36;
	[HideInInspector]
	public iGUIImage image35;
	[HideInInspector]
	public iGUIImage image34;
	[HideInInspector]
	public iGUIImage image33;
	[HideInInspector]
	public iGUIImage image32;
	[HideInInspector]
	public iGUIImage image31;
	[HideInInspector]
	public iGUIImage image30;
	[HideInInspector]
	public iGUIImage image29;
	[HideInInspector]
	public iGUIImage image28;
	[HideInInspector]
	public iGUIImage image27;
	[HideInInspector]
	public iGUIImage image26;
	[HideInInspector]
	public iGUIImage image25;
	[HideInInspector]
	public iGUIImage image24;
	[HideInInspector]
	public iGUIImage image23;
	[HideInInspector]
	public iGUIImage image22;
	[HideInInspector]
	public iGUIImage image21;
	[HideInInspector]
	public iGUIImage image20;
	[HideInInspector]
	public iGUIImage image19;
	[HideInInspector]
	public iGUIImage image18;
	[HideInInspector]
	public iGUIImage image17;
	[HideInInspector]
	public iGUIImage image16;
	[HideInInspector]
	public iGUIImage image15;
	[HideInInspector]
	public iGUIImage image14;
	[HideInInspector]
	public iGUIImage image13;
	[HideInInspector]
	public iGUIImage image12;
	[HideInInspector]
	public iGUIImage image11;
	[HideInInspector]
	public iGUIImage image10;
	[HideInInspector]
	public iGUIImage image9;
	[HideInInspector]
	public iGUIImage image8;
	[HideInInspector]
	public iGUIImage image7;
	[HideInInspector]
	public iGUIImage image6;
	[HideInInspector]
	public iGUIImage image5;
	[HideInInspector]
	public iGUIImage image4;
	[HideInInspector]
	public iGUIImage image3;
	[HideInInspector]
	public iGUIImage image2;
	[HideInInspector]
	public iGUIContainer container2;
	[HideInInspector]
	public iGUICheckboxGroup checkboxGroup2;
	[HideInInspector]
	public iGUIFloatHorizontalSlider floatHorizontalSlider2;
	[HideInInspector]
	public iGUICheckboxGroup checkboxGroup1;
	[HideInInspector]
	public iGUIFloatHorizontalSlider floatHorizontalSlider1;
	[HideInInspector]
	public iGUILabel label201;
	[HideInInspector]
	public iGUILabel label196;
	[HideInInspector]
	public iGUILabel label191;
	[HideInInspector]
	public iGUILabel label186;
	[HideInInspector]
	public iGUILabel label181;
	[HideInInspector]
	public iGUILabel label176;
	[HideInInspector]
	public iGUILabel label171;
	[HideInInspector]
	public iGUILabel label166;
	[HideInInspector]
	public iGUILabel label161;
	[HideInInspector]
	public iGUILabel label156;
	[HideInInspector]
	public iGUILabel label151;
	[HideInInspector]
	public iGUILabel label146;
	[HideInInspector]
	public iGUILabel label141;
	[HideInInspector]
	public iGUILabel label136;
	[HideInInspector]
	public iGUILabel label131;
	[HideInInspector]
	public iGUILabel label126;
	[HideInInspector]
	public iGUILabel label121;
	[HideInInspector]
	public iGUILabel label116;
	[HideInInspector]
	public iGUILabel label111;
	[HideInInspector]
	public iGUILabel label106;
	[HideInInspector]
	public iGUILabel label101;
	[HideInInspector]
	public iGUILabel label100;
	[HideInInspector]
	public iGUILabel label99;
	[HideInInspector]
	public iGUILabel label98;
	[HideInInspector]
	public iGUILabel label97;
	[HideInInspector]
	public iGUILabel label96;
	[HideInInspector]
	public iGUILabel label95;
	[HideInInspector]
	public iGUILabel label94;
	[HideInInspector]
	public iGUILabel label93;
	[HideInInspector]
	public iGUILabel label92;
	[HideInInspector]
	public iGUILabel label91;
	[HideInInspector]
	public iGUILabel label90;
	[HideInInspector]
	public iGUILabel label89;
	[HideInInspector]
	public iGUILabel label88;
	[HideInInspector]
	public iGUILabel label87;
	[HideInInspector]
	public iGUILabel label86;
	[HideInInspector]
	public iGUILabel label85;
	[HideInInspector]
	public iGUILabel label84;
	[HideInInspector]
	public iGUILabel label83;
	[HideInInspector]
	public iGUILabel label82;
	[HideInInspector]
	public iGUILabel label81;
	[HideInInspector]
	public iGUILabel label80;
	[HideInInspector]
	public iGUILabel label79;
	[HideInInspector]
	public iGUILabel label78;
	[HideInInspector]
	public iGUILabel label77;
	[HideInInspector]
	public iGUILabel label76;
	[HideInInspector]
	public iGUILabel label75;
	[HideInInspector]
	public iGUILabel label74;
	[HideInInspector]
	public iGUILabel label73;
	[HideInInspector]
	public iGUILabel label72;
	[HideInInspector]
	public iGUILabel label71;
	[HideInInspector]
	public iGUILabel label70;
	[HideInInspector]
	public iGUILabel label69;
	[HideInInspector]
	public iGUILabel label68;
	[HideInInspector]
	public iGUILabel label67;
	[HideInInspector]
	public iGUILabel label66;
	[HideInInspector]
	public iGUILabel label65;
	[HideInInspector]
	public iGUILabel label64;
	[HideInInspector]
	public iGUILabel label63;
	[HideInInspector]
	public iGUILabel label62;
	[HideInInspector]
	public iGUILabel label61;
	[HideInInspector]
	public iGUILabel label60;
	[HideInInspector]
	public iGUILabel label59;
	[HideInInspector]
	public iGUILabel label58;
	[HideInInspector]
	public iGUILabel label57;
	[HideInInspector]
	public iGUILabel label56;
	[HideInInspector]
	public iGUILabel label55;
	[HideInInspector]
	public iGUILabel label54;
	[HideInInspector]
	public iGUILabel label53;
	[HideInInspector]
	public iGUILabel label52;
	[HideInInspector]
	public iGUILabel label51;
	[HideInInspector]
	public iGUILabel label50;
	[HideInInspector]
	public iGUILabel label49;
	[HideInInspector]
	public iGUILabel label48;
	[HideInInspector]
	public iGUILabel label47;
	[HideInInspector]
	public iGUILabel label46;
	[HideInInspector]
	public iGUILabel label45;
	[HideInInspector]
	public iGUILabel label44;
	[HideInInspector]
	public iGUILabel label43;
	[HideInInspector]
	public iGUILabel label42;
	[HideInInspector]
	public iGUILabel label41;
	[HideInInspector]
	public iGUILabel label40;
	[HideInInspector]
	public iGUILabel label39;
	[HideInInspector]
	public iGUILabel label38;
	[HideInInspector]
	public iGUILabel label37;
	[HideInInspector]
	public iGUILabel label36;
	[HideInInspector]
	public iGUILabel label35;
	[HideInInspector]
	public iGUILabel label34;
	[HideInInspector]
	public iGUILabel label33;
	[HideInInspector]
	public iGUILabel label32;
	[HideInInspector]
	public iGUILabel label31;
	[HideInInspector]
	public iGUILabel label30;
	[HideInInspector]
	public iGUILabel label29;
	[HideInInspector]
	public iGUILabel label28;
	[HideInInspector]
	public iGUILabel label27;
	[HideInInspector]
	public iGUILabel label26;
	[HideInInspector]
	public iGUILabel label25;
	[HideInInspector]
	public iGUILabel label24;
	[HideInInspector]
	public iGUILabel label23;
	[HideInInspector]
	public iGUILabel label22;
	[HideInInspector]
	public iGUILabel label21;
	[HideInInspector]
	public iGUILabel label20;
	[HideInInspector]
	public iGUILabel label19;
	[HideInInspector]
	public iGUILabel label18;
	[HideInInspector]
	public iGUILabel label17;
	[HideInInspector]
	public iGUILabel label16;
	[HideInInspector]
	public iGUILabel label15;
	[HideInInspector]
	public iGUILabel label14;
	[HideInInspector]
	public iGUILabel label13;
	[HideInInspector]
	public iGUILabel label12;
	[HideInInspector]
	public iGUILabel label11;
	[HideInInspector]
	public iGUILabel label10;
	[HideInInspector]
	public iGUILabel label9;
	[HideInInspector]
	public iGUILabel label8;
	[HideInInspector]
	public iGUILabel label7;
	[HideInInspector]
	public iGUILabel label6;
	[HideInInspector]
	public iGUILabel label5;
	[HideInInspector]
	public iGUILabel label4;
	[HideInInspector]
	public iGUILabel label3;
	[HideInInspector]
	public iGUILabel label2;
	[HideInInspector]
	public iGUILabel label1;
	[HideInInspector]
	public iGUIContainer container1;
	[HideInInspector]
	public iGUIImage image1;
	[HideInInspector]
	public iGUIRoot root1;

	private GameObject corneaAnt;
	private GameObject corneaPost;
	private GameObject corneaBorder;
	private GameObject crossTarget1;
	private GameObject crossTarget2;
	private GameObject pachymetry;
	private GameObject antLine;
	private GameObject postLine;
	private GameObject corneaAntIntersect;
	private GameObject corneaBorderIntersect;

	private CorneaColorMapping corneaColorAnt;
	private CorneaColorMapping corneaColorPost;
	private CorneaColorMapping corneaColorAntIntersect;
	private PachymetryColors pachymetryColors;
	public static Sphere BFSAnt;
	public static Sphere BFSPost;
	public static bool isDeformed;

	private Color32[] glassColorsAnt;
	private Color32[] glassColorsPost;
	private Color32[] colorsAnt;
	private Color32[] colorsPost;
	private Color32[] colorsBorder;

	private int activePanel;

	private static iGUICode_CorneaScene instance;
	private Material colorMaterial;
	private Material glassMaterial;
	private bool isGlass;

	private VolumeDeformation volumeDeformation;
	//private Vector3[] border;
	
	void Awake(){
		Handheld.StopActivityIndicator();
		instance=this;
	}

	void Start()
	{
		this.activePanel = 0;
		this.corneaAnt = GameObject.FindGameObjectWithTag ("corneaCollider");
		Mesh meshCorneaAnt = corneaAnt.GetComponent<MeshFilter> ().mesh;

		// Calculate the BFS
		BFSAnt = MobileUnityInterface.BFSAnt;

		// Set the colors mapping to the mesh
		this.corneaColorAnt = new CorneaColorMapping ();
		this.corneaColorAnt.calculateDistances (meshCorneaAnt.vertices, BFSAnt);

		this.colorsAnt = this.corneaColorAnt.calculateColor ();
		meshCorneaAnt.colors32 = this.colorsAnt;

		SphereCollider corneaColliderAnt = this.corneaAnt.AddComponent<SphereCollider> ();
		//corneaColliderAnt.sharedMesh = meshCorneaAnt;
		corneaColliderAnt.center = new Vector3(BFSAnt.CX, BFSAnt.CY, BFSAnt.CZ);
		corneaColliderAnt.radius = BFSAnt.R;

		glassColorsAnt = new Color32[meshCorneaAnt.vertices.Length];
		for(int i = 0; i < meshCorneaAnt.vertices.Length; i++)
			this.glassColorsAnt[i] = new Color32(169, 234, 254, 255);

		/////////////////////////////////////////////////////////////////////////////////////////////////
		/// 
		this.corneaPost = GameObject.FindGameObjectWithTag ("corneaPost");
		Mesh meshCorneaPost = corneaPost.GetComponent<MeshFilter> ().mesh;

		this.colorMaterial = corneaPost.GetComponent<MeshRenderer>().material;

		// Calculate the BFS
		BFSPost = CorneaPostSurface.BFSPost;

		// Set the colors mapping to the mesh
		this.corneaColorPost = new CorneaColorMapping ();
		this.corneaColorPost.calculateDistances (meshCorneaPost.vertices, BFSPost);

		this.colorsPost = this.corneaColorPost.calculateColor ();
		meshCorneaPost.colors32 = this.colorsPost;

		SphereCollider corneaColliderPost = this.corneaPost.AddComponent<SphereCollider> ();
		//corneaColliderPost.sharedMesh = meshCorneaPost;
		corneaColliderPost.center = new Vector3(BFSPost.CX, BFSPost.CY, BFSPost.CZ);
		corneaColliderPost.radius = BFSPost.R;

		glassColorsPost = new Color32[meshCorneaPost.vertices.Length];
		for(int i = 0; i < meshCorneaPost.vertices.Length; i++)
			this.glassColorsPost[i] = new Color32(169, 234, 254, 255);

		this.crossTarget1 = GameObject.FindGameObjectWithTag ("crossTarget1");
		this.crossTarget1.renderer.enabled = false;
		this.crossTarget2 = GameObject.FindGameObjectWithTag ("crossTarget2");
		this.crossTarget2.renderer.enabled = false;

		////////////////////////////////////////////////////////////////////////////////////////////////////
		/// 
		this.pachymetry = GameObject.FindGameObjectWithTag ("Pachymetry");
		Mesh meshPachymetry = this.pachymetry.GetComponent<MeshFilter> ().mesh;

		this.pachymetryColors = new PachymetryColors ();
		meshPachymetry.colors32 = this.pachymetryColors.calculateColor (PachymetryCornea.elevationArrayPach);

		//////////////////////////////////////////////////////////////////////////////////////////////////
		/// 
		this.corneaBorder = GameObject.FindGameObjectWithTag ("CorneaBorder");

		this.colorsBorder = new Color32[corneaBorder.GetComponent<MeshFilter> ().mesh.vertices.Length];
		for(int i = 0; i < this.colorsBorder.Length; i++)
			this.colorsBorder[i] = new Color32(169, 234, 254, 255);

		this.corneaBorder.GetComponent<MeshFilter> ().mesh.colors32 = this.colorsBorder;
		this.glassMaterial = corneaBorder.GetComponent<MeshRenderer>().material;
		corneaBorder.GetComponent<MeshRenderer> ().material = this.colorMaterial;

		this.corneaBorderIntersect = GameObject.FindGameObjectWithTag("CorneaBorderIntersect");
		Color32[] colorBorderIntersect = new Color32[this.corneaBorderIntersect.GetComponent<MeshFilter>().mesh.vertices.Length];
		for(int i = 0; i < colorBorderIntersect.Length; i++)
			colorBorderIntersect[i] = new Color32(169, 234, 154, 255);

		this.corneaBorderIntersect.GetComponent<MeshFilter>().mesh.colors32 = colorBorderIntersect;

		this.isGlass = true;

		this.antLine = GameObject.FindGameObjectWithTag ("antBorderLine");
		this.postLine = GameObject.FindGameObjectWithTag ("postBorderLine");
		this.corneaAntIntersect = GameObject.FindGameObjectWithTag("CorneaAntIntersect");

		// Set the colors mapping to the mesh
		this.corneaColorAntIntersect = new CorneaColorMapping ();
		Mesh corneaAntIntersectMesh = this.corneaAntIntersect.GetComponent<MeshFilter>().mesh;
		corneaColorAntIntersect.calculateDistances (corneaAntIntersectMesh.vertices, BFSAnt);		
		corneaAntIntersectMesh.colors32 = corneaColorAntIntersect.calculateColor ();

		/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
		/// 

		this.volumeDeformation = new VolumeDeformation();
		//this.border = new Vector3[colorBorderIntersect.Length];
	}

	public static iGUICode_CorneaScene getInstance(){
		return instance;
	}

	public void floatHorizontalSlider1_ValueChange(iGUIFloatHorizontalSlider caller)
	{
		Mesh meshCornea = corneaAnt.GetComponent<MeshFilter> ().mesh;
		meshCornea.vertices = this.corneaColorAnt.zCorneaDeformate (floatHorizontalSlider1.value, meshCornea.vertices);

		if(this.activePanel == 0)
		{
			// ruler enabling
			if(floatHorizontalSlider1.value != 0f)
				container1.setEnabled(false);
			else
				container1.setEnabled(true);
		}
	}

	public void checkboxGroup1_ValueChange(iGUICheckboxGroup caller){
		Mesh meshCornea = corneaAnt.GetComponent<MeshFilter> ().mesh;
		if (checkboxGroup1.selectedIndex == 0)
		{
			container2.enabled = true;
			container3.enabled = false;
			meshCornea.colors32 = this.corneaColorAnt.calculateColor();
		}
		else if (checkboxGroup1.selectedIndex == 1)
		{
			container2.enabled = false;
			container3.enabled = true;
			meshCornea.colors32 = this.corneaColorAnt.calculateColorSmooth ();
		}
	}

	public void floatHorizontalSlider2_ValueChange(iGUIFloatHorizontalSlider caller){
		Mesh meshCornea = corneaPost.GetComponent<MeshFilter> ().mesh;
		meshCornea.vertices = this.corneaColorPost.zCorneaDeformate (floatHorizontalSlider2.value, meshCornea.vertices);
		if(this.activePanel == 1)
		{
			// ruler enabling
			if(floatHorizontalSlider2.value != 0f)
				container1.setEnabled(false);
			else
				container1.setEnabled(true);
		}
	}

	public void checkboxGroup2_ValueChange(iGUICheckboxGroup caller){
		Mesh meshCornea = corneaPost.GetComponent<MeshFilter> ().mesh;
		if (checkboxGroup2.selectedIndex == 0)
		{
			container5.enabled = true;
			container6.enabled = false;
			meshCornea.colors32 = this.corneaColorPost.calculateColor();
		}
		else if (checkboxGroup2.selectedIndex == 1)
		{
			container5.enabled = false;
			container6.enabled = true;
			meshCornea.colors32 = this.corneaColorPost.calculateColorSmooth ();
		}
	}

	///////////////////////////////////////////////////////////////////////////////////////////////////////////////
	/// 

	public void checkboxGroup3_ValueChange(iGUICheckboxGroup caller){
		Mesh meshCornea = this.pachymetry.GetComponent<MeshFilter> ().mesh;
		if (checkboxGroup3.selectedIndex == 0)
		{
			container8.enabled = true;
			container9.enabled = false;
			meshCornea.colors32 = this.pachymetryColors.calculateColor (PachymetryCornea.elevationArrayPach);
		}
		else if (checkboxGroup3.selectedIndex == 1)
		{
			container8.enabled = false;
			container9.enabled = true;
			meshCornea.colors32 = this.pachymetryColors.calculateColorSmooth (PachymetryCornea.elevationArrayPach);
		}
	}

	public void tabPanel2_TabChange(iGUITabPanel caller){
		this.activePanel = tabPanel2.activePanel;
		if(this.activePanel == 0)
		{
			Destroy(corneaAnt.GetComponent("DigitalMovements"));
			Destroy(corneaPost.GetComponent("DigitalMovements"));
			Destroy(pachymetry.GetComponent("DigitalMovements"));
			corneaAnt.AddComponent("DigitalMovements");

			corneaAnt.renderer.enabled = true;
			corneaPost.renderer.enabled = false;
			this.pachymetry.renderer.enabled = false;
			this.corneaBorder.renderer.enabled = false;
			this.crossTarget2.renderer.enabled = false;
			this.corneaAntIntersect.renderer.enabled = false;
			corneaAnt.GetComponent<MeshRenderer>().material = this.colorMaterial;
			antLine.GetComponent<LineRenderer>().renderer.enabled = false;
			postLine.GetComponent<LineRenderer>().renderer.enabled = false;
			
			// ruler enabling
			floatHorizontalSlider1.setValue(0f);
			floatHorizontalSlider3.setValue(0f);
			floatHorizontalSlider4.setValue(0f);
			container1.setEnabled(true);

			if(checkboxGroup1.selectedIndex == 0)
				corneaAnt.GetComponent<MeshFilter>().mesh.colors32 = this.corneaColorAnt.calculateColor();
			else if(checkboxGroup1.selectedIndex == 1)
				corneaAnt.GetComponent<MeshFilter>().mesh.colors32 = this.corneaColorAnt.calculateColorSmooth();
		}
		else if(this.activePanel == 1)
		{
			Destroy(corneaAnt.GetComponent("DigitalMovements"));
			Destroy (pachymetry.GetComponent("DigitalMovements"));
			corneaPost.AddComponent("DigitalMovements");

			corneaPost.renderer.enabled = true;
			corneaAnt.renderer.enabled = false;
			this.pachymetry.renderer.enabled = false;
			this.corneaBorder.renderer.enabled = false;
			this.crossTarget1.renderer.enabled = false;
			this.corneaAntIntersect.renderer.enabled = false;
			corneaPost.GetComponent<MeshRenderer>().material = this.colorMaterial;
			antLine.GetComponent<LineRenderer>().renderer.enabled = false;
			postLine.GetComponent<LineRenderer>().renderer.enabled = false;
			
			// ruler enabling
			floatHorizontalSlider2.setValue(0f);
			floatHorizontalSlider3.setValue(0f);
			floatHorizontalSlider4.setValue(0f);
			container1.setEnabled(true);

			if(checkboxGroup2.selectedIndex == 0)
				corneaPost.GetComponent<MeshFilter>().mesh.colors32 = this.corneaColorPost.calculateColor();
			else if(checkboxGroup2.selectedIndex == 1)
				corneaPost.GetComponent<MeshFilter>().mesh.colors32 = this.corneaColorPost.calculateColorSmooth();
		}
		else if(this.activePanel == 2)
		{
			this.pachymetry.AddComponent("DigitalMovements");
			Destroy(corneaAnt.GetComponent("DigitalMovements"));
			Destroy(corneaPost.GetComponent("DigitalMovements"));
			pachymetry.renderer.enabled = true;
			corneaAnt.renderer.enabled = false;
			corneaPost.renderer.enabled = false;
			this.corneaBorder.renderer.enabled = false;
			this.corneaAntIntersect.renderer.enabled = false;
			antLine.GetComponent<LineRenderer>().renderer.enabled = false;
			postLine.GetComponent<LineRenderer>().renderer.enabled = false;
		}
		else if(this.activePanel == 3)
		{
			Destroy(corneaAnt.GetComponent("DigitalMovements"));
			Destroy(pachymetry.GetComponent("DigitalMovements"));
			Destroy(corneaPost.GetComponent("DigitalMovements"));
			corneaAnt.AddComponent("DigitalMovements");

			floatHorizontalSlider1.setValue(0f);
			floatHorizontalSlider2.setValue(0f);
			floatHorizontalSlider3.setValue(0f);
			floatHorizontalSlider4.setValue(0f);

			pachymetry.renderer.enabled = false;
			corneaAnt.renderer.enabled = true;
			corneaPost.renderer.enabled = true;
			this.corneaBorder.renderer.enabled = true;
			antLine.GetComponent<LineRenderer>().renderer.enabled = true;
			postLine.GetComponent<LineRenderer>().renderer.enabled = true;

			if(this.isGlass == true)
				setGlassCornea();
			else
			{
				corneaAnt.GetComponent<MeshRenderer>().material = this.colorMaterial;
				corneaPost.GetComponent<MeshRenderer>().material = this.colorMaterial;
				corneaBorder.GetComponent<MeshRenderer>().material = this.colorMaterial;

				if(checkboxGroup4.selectedIndex == 1)
				{
					corneaAnt.GetComponent<MeshFilter>().mesh.colors32 = this.corneaColorAnt.calculateColor();
					corneaPost.GetComponent<MeshFilter>().mesh.colors32 = this.corneaColorPost.calculateColor();
				}
				else if(checkboxGroup4.selectedIndex == 2)
				{
					corneaAnt.GetComponent<MeshFilter>().mesh.colors32 = this.corneaColorAnt.calculateColorSmooth();
					corneaPost.GetComponent<MeshFilter>().mesh.colors32 = this.corneaColorPost.calculateColorSmooth();
				}
				else if(checkboxGroup4.selectedIndex == 3)
				{
					corneaAnt.GetComponent<MeshFilter>().mesh.colors32 = BorderCornea.elevationColorMapAnt;
					corneaPost.GetComponent<MeshFilter>().mesh.colors32 = BorderCornea.elevationColorMapPost;
				}
				else if(checkboxGroup4.selectedIndex == 4)
				{
					corneaAnt.GetComponent<MeshFilter>().mesh.colors32 = BorderCornea.elevationSmoothColorMapAnt;
					corneaPost.GetComponent<MeshFilter>().mesh.colors32 = BorderCornea.elevationSmoothColorMapPost;
				}
			}
		}
	}

	public void checkboxGroup4_ValueChange(iGUICheckboxGroup caller){
		Mesh meshCorneaAnt = this.corneaAnt.GetComponent<MeshFilter> ().mesh;
		Mesh meshCorneaPost = this.corneaPost.GetComponent<MeshFilter> ().mesh;
		Mesh corneaAntIntersectMesh = this.corneaAntIntersect.GetComponent<MeshFilter>().mesh;

		if (checkboxGroup4.selectedIndex == 0)
		{
			this.isGlass = true;
			setGlassCornea();
		}
		else if (checkboxGroup4.selectedIndex == 1)
		{
			//container8.enabled = true;
			//container9.enabled = false;
			corneaAnt.GetComponent<MeshRenderer>().material = this.colorMaterial;
			corneaPost.GetComponent<MeshRenderer>().material = this.colorMaterial;
			corneaBorder.GetComponent<MeshRenderer>().material = this.colorMaterial;
			meshCorneaAnt.colors32 = this.corneaColorAnt.calculateColor();
			meshCorneaPost.colors32 = this.corneaColorPost.calculateColor();
			corneaAntIntersectMesh.colors32 = corneaColorAntIntersect.calculateColor ();
			this.isGlass = false;
		}
		else if(checkboxGroup4.selectedIndex == 2)
		{
			//container8.enabled = false;
			//container9.enabled = true;
			corneaAnt.GetComponent<MeshRenderer>().material = this.colorMaterial;
			corneaPost.GetComponent<MeshRenderer>().material = this.colorMaterial;
			corneaBorder.GetComponent<MeshRenderer>().material = this.colorMaterial;
			meshCorneaAnt.colors32 = this.corneaColorAnt.calculateColorSmooth();
			meshCorneaPost.colors32 = this.corneaColorPost.calculateColorSmooth();
			corneaAntIntersectMesh.colors32 = corneaColorAntIntersect.calculateColorSmooth ();
			this.isGlass = false;
		}
		else if(checkboxGroup4.selectedIndex == 3)
		{
			//container8.enabled = false;
			//container9.enabled = true;
			corneaAnt.GetComponent<MeshRenderer>().material = this.colorMaterial;
			corneaPost.GetComponent<MeshRenderer>().material = this.colorMaterial;
			corneaBorder.GetComponent<MeshRenderer>().material = this.colorMaterial;
			meshCorneaAnt.colors32 = BorderCornea.elevationColorMapAnt;
			meshCorneaPost.colors32 = BorderCornea.elevationColorMapPost;
			corneaAntIntersectMesh.colors32 = BorderCornea.elevationColorMapPost;
			this.isGlass = false;
		}
		else if(checkboxGroup4.selectedIndex == 4)
		{
			//container8.enabled = false;
			//container9.enabled = true;
			corneaAnt.GetComponent<MeshRenderer>().material = this.colorMaterial;
			corneaPost.GetComponent<MeshRenderer>().material = this.colorMaterial;
			corneaBorder.GetComponent<MeshRenderer>().material = this.colorMaterial;
			meshCorneaAnt.colors32 = BorderCornea.elevationSmoothColorMapAnt;
			meshCorneaPost.colors32 = BorderCornea.elevationSmoothColorMapPost;
			corneaAntIntersectMesh.colors32 = BorderCornea.elevationSmoothColorMapPost;
			this.isGlass = false;
		}
	}

	public void setGlassCornea()
	{
		corneaAnt.GetComponent<MeshRenderer>().material = this.glassMaterial;
		corneaAnt.GetComponent<MeshFilter>().mesh.colors32 = this.glassColorsAnt;
		corneaPost.GetComponent<MeshRenderer>().material = this.glassMaterial;
		corneaPost.GetComponent<MeshFilter>().mesh.colors32 = this.glassColorsPost;
		corneaBorder.GetComponent<MeshRenderer>().material = this.glassMaterial;
	}
	public void button1_Click(iGUIButton caller){
		Application.LoadLevel("MenuScene");
	}

	public void button2_Click(iGUIButton caller){
		Application.LoadLevel("MenuScene");
	}

	public void button3_Click(iGUIButton caller){
		Application.LoadLevel("MenuScene");
	}

	public void button4_Click(iGUIButton caller){
		Application.LoadLevel("MenuScene");
	}

	public void floatHorizontalSlider3_ValueChange(iGUIFloatHorizontalSlider caller){
		Mesh meshCorneaA = corneaAntIntersect.GetComponent<MeshFilter> ().mesh;
		Mesh meshCorneaP = corneaPost.GetComponent<MeshFilter>().mesh;
		//Mesh meshBordure = corneaBorderIntersect.GetComponent<MeshFilter>().mesh;

		meshCorneaA.vertices = volumeDeformation.zCorneaDeformateAnt1(floatHorizontalSlider3.value, meshCorneaA.vertices);
		meshCorneaP.vertices = volumeDeformation.zCorneaDeformatePost1(floatHorizontalSlider3.value, meshCorneaP.vertices);
		//meshBordure.vertices = volumeDeformation.zCorneaDeformateBorder(floatHorizontalSlider4.value, meshBordure.vertices);
		if(this.activePanel == 3)
		{
			// ruler enabling
			if(floatHorizontalSlider3.value != 0f)
			{
				this.corneaBorder.renderer.enabled = false;
				this.corneaBorderIntersect.renderer.enabled = true;
				corneaAnt.GetComponent<MeshRenderer>().enabled = false;
				corneaAntIntersect.GetComponent<MeshRenderer>().enabled = true;
				container1.setEnabled(false);
				floatHorizontalSlider4.enabled = false;

			}
			else
			{
				this.corneaBorder.renderer.enabled = true;
				this.corneaBorderIntersect.renderer.enabled = false;
				corneaAnt.GetComponent<MeshRenderer>().enabled = true;
				corneaAntIntersect.GetComponent<MeshRenderer>().enabled = false;
				container1.setEnabled(true);
				floatHorizontalSlider4.enabled = true;
			}
		}
	}

	public void floatHorizontalSlider4_ValueChange(iGUIFloatHorizontalSlider caller){
		Mesh meshCorneaA = corneaAntIntersect.GetComponent<MeshFilter> ().mesh;
		Mesh meshCorneaP = corneaPost.GetComponent<MeshFilter>().mesh;
		Mesh meshBordure = corneaBorderIntersect.GetComponent<MeshFilter>().mesh;
		
		meshCorneaA.vertices = volumeDeformation.zCorneaDeformateAnt2(floatHorizontalSlider4.value, meshCorneaA.vertices);
		meshCorneaP.vertices = volumeDeformation.zCorneaDeformatePost2(floatHorizontalSlider4.value, meshCorneaP.vertices);

		//Vector3[] borderAnt = volumeDeformation.zCorneaDeformateAnt2(floatHorizontalSlider4.value, BorderCornea.borderAntIntersectVertices);
		//Vector3[] borderPost = volumeDeformation.zCorneaDeformatePost2(floatHorizontalSlider4.value, BorderCornea.borderPostIntersectVertices);

		/*for(int i = 0; i < borderAnt.Length; i++)
			this.border[i] = borderAnt[i];
		for(int i = 0; i < borderPost.Length; i++)
			this.border[borderAnt.Length + i] = borderPost[i];
*/
		meshBordure.vertices = volumeDeformation.zCorneaDeformateBorder(floatHorizontalSlider4.value, meshBordure.vertices);
		
		if(this.activePanel == 3)
		{
			// ruler enabling
			if(floatHorizontalSlider4.value != 0f)
			{
				this.corneaBorder.renderer.enabled = false;
				this.corneaBorderIntersect.renderer.enabled = true;
				corneaAnt.GetComponent<MeshRenderer>().enabled = false;
				corneaAntIntersect.GetComponent<MeshRenderer>().enabled = true;
				container1.setEnabled(false);
				floatHorizontalSlider3.enabled = false;
			}
			else
			{
				this.corneaBorder.renderer.enabled = true;
				this.corneaBorderIntersect.renderer.enabled = false;
				corneaAnt.GetComponent<MeshRenderer>().enabled = true;
				corneaAntIntersect.GetComponent<MeshRenderer>().enabled = false;
				container1.setEnabled(true);
				floatHorizontalSlider3.enabled = true;
			}
		}
	}
}
